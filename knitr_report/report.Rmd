---
title: "ASIS report"
output:
  html_document:
    toc: true
    theme: united
date: '`r format(Sys.time(), "%d %B, %Y")`'
author: 'CTL ASIS user'
---

```{r, include=FALSE}
options(tinytex.verbose = TRUE)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE, fig.align="center")
knitr::opts_chunk$set(echo = TRUE, warning=FALSE)
```


```{r echo = FALSE, fig.margin=TRUE, results = "asis"}
load("write_info.RData")
for(i in 1:nrow(our_info)) if(our_info$summary_decision1[i] == "") our_info$summary_decision1[i] = our_info$decision21[i]
our_info = our_info[-c(which(our_info$decision7 == "")),]

for(j in 1:nrow(our_info)){
  if(our_info$evid[j] != ""){
    if(our_info$decision[j] == ""){
      our_info$decision[j] = our_info$evid[j]
    }else{
      if(our_info$decision4[j] == ""){
        our_info$decision4[j] = our_info$evid[j]
      }
    }
  }
}
input <- our_info

##################################################
nname <- vector()
nname[1] <- "Module"
nname[2] <- "Other things like aonva"
nname[3] <- "correlation or somethinglah"
nname[4] <- "even after other things"
nname[5] <- "coree what what even after other things"

names(our_info)[3:6] <-  c("table1", 'table2','table3','table4')#nname
our_info[, 3:6] %>%
  mutate(
    Module = our_info$module,
    table1 = text_spec(table1, "html", color = ifelse(table1 == "No*", "red", "blue")),
    table2 = text_spec(table2, "html", color = ifelse(table2 == "No*", "red", "blue")),
    table3 = text_spec(table3, "html", color = ifelse(table3 == "No*", "red", "blue")),
    table4 = text_spec(table4, "html", color = ifelse(table4 == "No*", "red", "blue")),
  ) %>%
select(Module, table1, table2, table3, table4) -> newTABLE
names(newTABLE) <- nname
newTABLE %>%  kable(format="markdown" ,escape = F,align = ) %>%
  kable_styling("bordered",position = "center") %>%
  footnote(general = "Here is a general comments of the table. ",
           number = c("Footnote 1; ", "Footnote 2; "),
           alphabet = c("Footnote A; ", "Footnote B; "),
           symbol = c("Footnote Symbol 1; ", "Footnote Symbol 2")
           )
##################################################


j <- as.numeric(rownames(input))
for (i in 1:length(j)) {
current <- input[i, ]
cat(paste0("# ",current$module,"\n"))
cat(paste0("## Summary \n"))
cat(paste0(current$summary_decision1, "\n"))
cat(paste0(current$summary_decision2, "\n"))
cat(paste0(current$summary_decision3))
cat(paste0(current$summary_decision4, "\n"))
cat(paste0("\n\n"))
cat(paste0("![](", "pic", j[i], ".pdf){width=65%}","\n"))
cat(paste0("\n\n"))
cat(paste0("## Evidence \n"))
cat(paste0(current$summary_stat, "\n\n"))
cat(paste0(current$decision, "\n\n"))
cat(paste0(current$decision4, "\n\n"))
cat(paste0(current$decision3, "\n\n"))
cat(paste0(current$decision5, "\n\n"))
cat(paste0(current$decision7, "\n\n"))
cat(paste0(current$decision8, "\n\n"))
}
```